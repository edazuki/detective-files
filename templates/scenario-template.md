# シナリオ制作テンプレート

このファイルを参考に、シナリオフォルダ内の各ファイルを作成してください。
シナリオフォルダは `scenarios/[事件番号_タイトル]/` に置きます。

---

## フォルダ構成

```
scenarios/
└── 事件XX_タイトル/
    ├── scenario.md        ← このテンプレートのセクション1
    ├── characters.md      ← このテンプレートのセクション2
    ├── clues.md           ← このテンプレートのセクション3
    ├── truth.md           ← このテンプレートのセクション4
    └── source-evidence/   ← 証拠ファイル原本（自由に作成）
```

---

## セクション1: scenario.md

```markdown
# シナリオ: [タイトル]

## シナリオへの特別指示（省略可）
[残酷描写がある場合の警告など]

---

## 導入テキスト

> [プレイヤーに最初に提示する状況説明。
>  「あなたは〜」の視点で書くと没入感が出る]

---

## 登場人物

- **[名前]**（役割、年齢）：[一言説明]

---

## 場所一覧

### [場所名]
- **アクセス条件**: [なし / フラグ名 / 好感度条件]
- **調査したとき**: `[flag_name]` フラグを立てる
- **調査できること**:
  - [アクション] → [結果・取得できる証拠]

---

## フラグ一覧

| フラグID | 意味 |
|---|---|
| `[flag_name]` | [説明] |

---

## クリア条件

- **最低証拠ファイル数**: [数字]
- **推奨フラグ**: [フラグ名のリスト]

---

## バッドエンド条件

| 条件 | エンド |
|---|---|
| [条件] | [結果] |
```

---

## セクション2: characters.md

```markdown
# 登場人物定義

---

## [キャラクター名]（役割）

\`\`\`yaml
id: [snake_case_id]
name: [名前]
role: [役割]
age: [年齢]
affinity_initial: [0-100]
trust_initial: [0-100]
affinity_change:
  [ポジティブなイベント]: +[数値]
  [ネガティブなイベント]: -[数値]
trust_change:
  [ポジティブなイベント]: +[数値]
  [ネガティブなイベント]: -[数値]

knowledge:
  initial:
    - "[このキャラクターが最初から知っていること]"
  acquired: []     # AIがプレイ中に追記（探偵から得た情報）
  concealed:
    - "[このキャラクターが意図的に隠していること]"

phases:
  - id: default
    condition: {}
    behavior: "[デフォルトの行動指針・態度]"
  - id: [phase_name]
    condition:
      flag_required: [flag_name]   # フラグ条件（省略可）
      affinity_[character_id]: [数値]  # 好感度条件（省略可）
    behavior: "[この局面での行動指針・態度の変化]"
\`\`\`

**人物像**: [性格・背景・秘密]

**会話トピック**:

- **[トピック名]**（条件: [なし / フラグ名 / affinity_xxx ≥ N]）
  - `sets_flag`: [flag_name]（省略可）
  - `reveals`: "[このトピックで話してくれる内容]"
```

---

## セクション3: clues.md

```markdown
# 証拠定義

\`\`\`yaml
clues:

  - id: [snake_case_id]
    file: source-evidence/[ファイル名]
    description: [証拠の内容説明（AIが画像等を読めない場合の代替）]
    condition:
      location: [場所名]                  # 場所条件
      action: [アクションの説明]           # 自然言語でどんな行動が必要か
      flag_required: [flag_name]          # 事前に必要なフラグ（省略可）
      affinity_[character_id]: [数値]     # 好感度条件（省略可）
    sets_flag: [flag_name]               # 取得時に立てるフラグ（省略可）
    copy_source: scenarios/[フォルダ名]/source-evidence/[ファイル名]
    copy_dest: evidence/[ファイル名]
    # パスは / 区切りで統一。AIが実行時にOSに合わせてコマンドを組み立てる。
    initial: false   # true にするとセッション開始時に条件なしで自動コピー（省略時 false）
    flavor_text: "[証拠発見時の演出テキスト]"
    # ⚠️ flavor_text はシナリオの時代設定・世界観と矛盾しないように書くこと。
    # 例：近代以前の設定で「ブラウザで開く」「スマホで確認」などの表現は使わない。
    display_name: "[プレイヤーへの表示名（日本語推奨）]"  # 省略可
    hint_level: high / medium / low
    supports:
      - [この証拠が支持する主張]
\`\`\`
```

---

## セクション4: truth.md

```markdown
# 真相ファイル

> ⚠️ このファイルはAIのみが参照します。プレイヤーには絶対に開示しないでください。

---

## 想定解

### 犯人
[犯人の名前]

### 動機
[動機の詳細]

### 方法
[犯行の手順]

---

## 解決判定の基準

### キーパーソン
- **[キャラクター名]**
  - affinity_threshold: [数値], trust_threshold: [数値]

### 最低証拠ファイル数
`evidence/` 内に **[数字]ファイル以上**（聴取メモ含む）

### 証明ポイント

| ポイント | 条件 |
|---|---|
| P1: [証明すべき事項] | [対応する証拠ID] |
| P2: [証明すべき事項] | [対応する証拠ID] |
| P3: [証明すべき事項] | [対応する証拠ID] |

### 判定閾値

| 充足率 | 条件 | 結果 |
|---|---|---|
| [X/X]（100%） | なし | 完全解決 |
| [X/X]（〇〇%） | なし | 解決 |
| [X/X]（〇〇%） | affinity ≥ [N] かつ trust ≥ [N] | 条件付き解決 |
| [X/X]以下 | — | 却下 |

---

## ボーナス演出テキスト（省略可）
[想定解と完全一致した場合のエンディングテキスト]

---

## AIへの注意事項
[プレイヤーへの誘導を禁ずる事項を記載]
```

---

## 証拠ファイルの作り方のヒント

| ファイル形式 | 向いている用途 | 例 |
|---|---|---|
| `.txt` | メモ・手紙・日記・分析結果 | 日記、帳簿、証言メモ |
| `.html` | 正式書類・複雑なレイアウト | 検死レポート、新聞記事 |
| `.md` | 読みやすい書式の文書 | 報告書、まとめ |
| `.jpg/.png` | 写真証拠・地図・図面 | 現場写真、地図（マルチモーダルAI推奨） |

証拠ファイルは「プレイヤーが実際に開いたとき、生々しくリアルに感じられる」内容にすると没入感が増します。

---

## 設計補助ツール：証拠-主張マトリクス

シナリオ設計時に「各証拠がどの主張を支持・否定できるか」を整理するためのマトリクスです。
これを埋めることで、別解が成立しうるか、または証拠の穴がないかを事前確認できます。

**作成方法**: 横軸に主張（犯人・動機・方法の要素）、縦軸に証拠IDを置き、`◎`（強く支持）・`○`（支持）・`△`（間接的）・`✗`（矛盾・否定）を記入する。

```markdown
## 証拠-主張マトリクス（シナリオ設計メモ）

| 証拠ID | 犯人=A | 犯人=B | 動機=X | 動機=Y | 方法=P | 密室解明 |
|---|---|---|---|---|---|---|
| evidence_01 | ◎ | — | ○ | — | — | — |
| evidence_02 | △ | ✗ | — | ◎ | — | — |
| interview_B | — | ◎ | — | — | ○ | — |
| ...         |   |   |   |   |   |   |

> **読み方**: ◎=強く支持, ○=支持, △=間接的/弱い支持, ✗=矛盾・否定, —=無関係
```

**チェックポイント**:
- 想定解（犯人A・動機X・方法P）の列が十分な `◎` `○` で埋まっているか？
- 別解（犯人B）の列が成立してしまう証拠ばかり揃っていないか？
- `✗` が少なすぎる場合、「何でもクリアできる」シナリオになっている可能性がある
- 別解を意図的に許容する設計にする場合は、その旨を `truth.md` に記載する
