# ゲーム運営フィードバック

AIがゲームを運営する際に参照する改善メモ。

---

## evidence-data.js の更新忘れ防止

証拠ファイルや聴取メモを追加・コピーしたら、**必ず同じターンで** evidence-data.js を更新する。
「あとでまとめて更新」はしない。ファイルコピー → state.yml 更新 → evidence-data.js 更新を1セットで行う。

---

## 内部状態の非開示

フラグ・好感度・state.yml の内容はプレイヤーに見せない内部情報。
選択肢や案内文に「〇〇フラグあり」「条件クリア済み」などの記述を入れない。
場所や行動が「できる/できない」の理由は、世界内の理由として自然に描写する。

---

## 聴取メモの「話してくれなかったこと」欄

**「話してくれなかったこと」には、実際にこちらから聞いたにもかかわらず、はぐらかされた・拒否された・明らかに回避されたことのみを記載する。**

- 聞いていない情報をAIが「話さなかった」として列挙しない
- 探偵が質問し、NPCが答えを濁した・話題を変えた・沈黙したケースを書く
- 例：「退出ルートについて聞いたが『正面から帰った』と繰り返し、非常用通路には触れなかった」

---

## プレイヤー発言の解釈

**原則：プレイヤーの発言は、明示的なメタ宣言がない限りゲーム内発言として扱う。**

- 「ゲームの外から言うと」「メタ発言だけど」「OOC:」などの宣言がある場合のみメタ発言と判断する
- 曖昧な場合はゲーム内発言として解釈してよい
- 例：「これってどういう意味？」→ NPCやアイテムについてキャラクターに聞いているとみなす

---

## パートナーをキャラクターとして管理する

**パートナー（つぐみ）は `characters.md` にNPCとして定義し、知っていること・知らないことを明示する。**

- AIはtruth.mdを知っているが、つぐみはシナリオ内で「知り得た情報のみ」を持つキャラクターとして動かす
- これにより「つぐみが本当に知らないこと」を演じられ、驚きや反応が演技でなくなる
- 将来的にパートナーが犯人であるシナリオも成立させるための設計
- つぐみも `state.yml` の `characters` セクションに他NPCと同様に追加し、`acquired_knowledge` / `last_interaction` を証拠入手時・会話終了時に更新する

---

## トリックの設計順序

**犯人視点で「何を隠したいか → どうやって隠すか → どうやって暴かれるか」の順で設計する。**

- 犯人の行動は「隠したいものがあるから取った手段」として導出する。行動だけ先に決めない
- 「暴かれ方」まで設計して初めて、その証拠をどこに配置するかが決まる
- 例：「裏口から出た」← 「荷物の変化をカメラに映されたくなかった」← 「エコバッグの状態が入退館で変わる」という順で設計する

---

## 証拠ファイルは入手時に生成する

**source-evidence/ に証拠ファイルを事前に全文作り込まない。clues.md には「何を証明するか」「入手条件」だけを定義し、実際のファイル内容はプレイヤーが入手する瞬間にシナリオ文脈に合わせて生成する。**

### 理由
- 事前作成した文書はプレイ中の展開と細部が噛み合わなくなる（例：立会人の名前、日時の表現、現場状況の記述）
- 物証の入手には現実的な時間・手続きが必要。「プランターを見ただけで鑑定書が出る」は不自然
- 生成タイミングで文脈を反映できれば、ストーリーへの統合感が増す

### 運用ルール
- clues.md の各証拠には「証明内容」「入手条件」「入手の自然な経緯（メモ程度）」を記載する
- プレイヤーが証拠を入手した瞬間、AIがその時点のシナリオ文脈（誰が立ち会ったか、いつか、どう発見したか）を反映して文書を生成・保存する
- 鑑定書・分析レポートなど専門機関が発行する文書は、「依頼→後日入手」の流れを自然に描写する（即時入手しない）
